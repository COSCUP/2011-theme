"use stricts";jQuery(function(e){var t,o=(e("html").attr("lang")||"zh-TW").toLowerCase();function n(){return!e("#title:visible").length}function i(){var t=[];e("#mobileSponsorLogo").remove(),e.each({diamond:10,gold:5,silver:2,bronze:1},function(o,n){e("#sidebar > .sponsors ."+o+" a").each(function(){for(var e=n;e--;)t.push(this)})}),0!==t.length&&e("#nav").after(e('<p id="mobileSponsorLogo" />').append(e(t[Math.floor(t.length*Math.random())]).clone()))}function a(){e("#sidebar2 > .images").imageTile({num:12,photos:yuren_54,beforeImageLoad:function(e,t){e.css("opacity",0)},imageLoad:function(e,t){e.css("opacity",1)}})}function r(){e("#sidebar2 > .images").length&&(e.fn.imageTile?a():e.ajax({url:"//coscup.org/2011-theme/assets/imagetile.min.js",dataType:"script",cache:!0,success:a})),e("#countdown-time").length&&(t=setInterval(v,1e3),e(window).bind("pageload",function(o){clearTimeout(t),e(window).unbind(o)}),v(),e("#countdown").addClass("show"))}function l(){e(window).trigger("pageload"),e("#header").css("background-position","center -"+(75*Math.floor(4*Math.random())).toString(10)+"px"),e("#footer").css("background-position","center -"+(75*Math.floor(6*Math.random())).toString(10)+"px"),n()?(window._gaq&&_gaq.push(["_trackEvent","Mobile 2011",window.location.href]),e(window).bind("resize.defer",function(){n()||(e(this).unbind("resize.defer"),r(),e("#sidebar2 iframe").each(function(){e(this).attr("data-src")&&(this.src=e(this).attr("data-src"))}))}),e(".hideInMobile iframe").each(function(){e(this).attr("data-src",this.src),this.src=""})):(r(),window.history&&history.pushState&&e("a").each(function(){this.hostname===window.location.hostname&&/2011/.test(this.pathname)&&new RegExp(o).test(this.pathname.toLowerCase())&&this.href!==window.location.href&&!h[this.href]&&"fetching"!==h[this.href]&&!/nocache/.test(this.getAttribute("rel"))&&(p.push(this.href),h[this.href]="fetching",1===p.length&&function t(){var o=p.shift();e.ajax({url:o,dataType:"html",cache:!0,complete:function(e,n){"success"!==n&&"notmodified"!==n||(h[o]=e.responseText),0!==p.length&&t()}})}())}))}e("#nav.empty").length&&e.getJSON("https://coscup.org/2011/api/menu.json",function(t){e("#nav").removeClass("empty").html(t[o].replace(/href="(\/[^\/])/g,'href="https://coscup.org$1')),e('#nav a[href*="'+window.location.hostname+'"]').parent().addClass("current")}),e(window).bind("pageload",i),e(window).bind("pageload",function(){if(e(".shortcuts")&&!((new Date).getTime()>parseInt(e(".program tbody th:last").attr("rel")+"000",10))){var t=e('<a href="#" />').text({"zh-tw":"目前議程","zh-cn":"目前议程",en:"Current Session"}[o]);t.bind("click",function(t){var o,n=(new Date).getTime();t.stopPropagation(),t.preventDefault(),e(".program tbody th").each(function(t,i){var s=parseInt(e(i).attr("rel")+"000",10);if(n<s&&o)return e(document.body).animate({scrollTop:e(o).offset().top-20},180),e(window).trigger("scroll"),!1;n>s&&(o=i)}),o||(e(document.body).animate({scrollTop:e(".program tbody th:first").offset().top-20},180),e(window).trigger("scroll"))}),e(".shortcuts").append(e('<li class="fullwidth" />').append(t)),e(".shortcuts").after('<a class="mobile_top" href="#"></a>');var n,i=e(".mobile_top");i.bind("click",function(){return e(window).trigger("scroll"),e(document.body).animate({scrollTop:e(".shortcuts").offset().top-20},180),!1}),e(window).bind("resize.mt scroll.mt",function(){i.removeClass("show"),clearTimeout(n),n=setTimeout(function(){e(".shortcuts").offset().top<e(document.body).scrollTop()&&i.css("top",e(document.body).scrollTop()+(window.innerHeight||e(window).height())-i.height()-15).addClass("show")},200)}),e(window).bind("pageload",function(t){clearTimeout(n),e(window).unbind("resize.mt scroll.mt").unbind(t)})}}),e("#sidebar > .sponsors.empty").length&&e.getJSON("https://coscup.org/2011/api/sponsors.json",function(t){var n=e("#sidebar > .sponsors").removeClass("empty"),s={en:{diamond:"Diamond Level Sponsors",gold:"Gold Level Sponsors",silver:"Silver Level Sponsors",bronze:"Bronze Level Sponsors",media:"Media Partners"},"zh-tw":{diamond:"鑽石級贊助",gold:"黃金級贊助",silver:"白銀級贊助",bronze:"青銅級贊助",media:"媒體夥伴"},"zh-cn":{diamond:"钻石级赞助",gold:"黄金级赞助",silver:"白银级赞助",bronze:"青铜级赞助",media:"媒体伙伴"}}[o];e.each(["diamond","gold","silver","bronze","media"],function(i,a){if(t[a]){n.append("<h2>"+s[a]+"</h2>");var r=e('<ul class="'+a+'" />');e.each(t[a],function(e,t){r.append('<li><a href="'+t.url+'" target="_blank"><img title="'+t.name[o]+'" src="'+t.logoUrl+'" /></a></li>')}),n.append(r)}}),i()}),e(".sponsors a, #mobileSponsorLogo a").live("click",function(){return window._gaq&&_gaq.push(["_trackEvent","Sponsors 2011",this.href]),!0}),e("#mobileSponsorLogo a").live("click",function(){return window._gaq&&_gaq.push(["_trackEvent","Sponsors 2011 (Mobile only)",this.href]),!0}),e(".shortcuts a").live("click",function(t){e(window).trigger("scroll"),t.preventDefault(),e(document.body).animate({scrollTop:e(this.hash).offset().top-20},180)}),e("#nav > ul > li").bind("touchstart",function(){var t=e(this);t.addClass("selected"),e(document.body).bind("touchend",function(o){t.removeClass("selected"),e(this).unbind(o)})}),e(".socialbuzz a").live("click",function(){return window.open(this.href),!1});var c,d,h={},p=[];function u(t,o,n){if(e(window).unbind("resize.defer"),c&&c.abort(),!o&&h[t]&&"fetching"!==h[t])n&&e(window).scrollTop(0),f(h[t]);else{var i=e("#content").addClass("loading");c=e.ajax({url:t,dataType:"html",cache:!o,complete:function(o,s){"success"===s||"notmodified"===s?(i.removeClass("loading"),h[t]=o.responseText,n&&e(window).scrollTop(0),f(o.responseText)):window.location.replace(t)}})}}function f(t){var o=e("<div />").append(t.match(/<body\b([^\u0000]+)<\/body>/)[0].replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,""));document.title=t.match(/<title>(.+)<\/title>/)[1],e("#content").html(o.find("#content").children()).removeClass("loading"),o.find("#nav").is(".empty")||e("#nav").html(o.find("#nav").children()),window._gaq&&_gaq.push(["_trackPageview"]),l()}if(l(),window.history&&history.pushState){var m="state"in window.history,g=location.href;e("a").live("click",function(t){if(2==t.which||t.metaKey)return!0;if(this.hostname!==window.location.hostname||!/2011/.test(this.pathname)||!new RegExp(o).test(this.pathname.toLowerCase())||"#"===this.getAttribute("href").substr(0,1)||/nocache/.test(this.getAttribute("rel")))return!0;e(this).parent("#nav li").addClass("loading");var n=this.href,i=this.href===window.location.href;return history.pushState({is:"pushed"},"",n),u(n,i,!0),m=!0,!1}),window.onpopstate=function(e){var t=!m&&location.href==g;m=!0,t||u(window.location.href,!1,!1)}}function w(){if(d){var t,i,s=(t={},e(".types li").each(function(o,n){t[(o+1).toString(10)]=e(this).text()}),t);e.fn.translateTo=function(e){return e?(e+=10,this.addClass("translate").css({"-webkit-transform":"translateX("+e.toString(10)+"px)","-moz-transform":"translateX("+e.toString(10)+"px)","-ms-transform":"translateX("+e.toString(10)+"px)",transform:"translateX("+e.toString(10)+"px)"})):this.removeClass("translate").css({"-webkit-transform":"","-moz-transform":"","-ms-transform":"",transform:""})},e("table.program").each(function(){var t=e(this);t.prev().after(e('<div class="program" />').append(t).bind("scroll",function(){var t=e(this);t.find("thead th:first, tbody th").translateTo(0),clearTimeout(i),i=setTimeout(function(){t.find("thead th:first, tbody th").translateTo(t.scrollLeft())},200)}).bind("touchstart",function(t){var o=e(this),i=e(window),s=t.clientX||t.originalEvent.touches[0].clientX,a=t.clientY||t.originalEvent.touches[0].clientY;o.hasClass("expend")&&!n()&&(o.addClass("movestart"),i.bind("touchmove",function(e){o.removeClass("movestart").addClass("moving").scrollLeft(o.scrollLeft()+s-(e.clientX||e.originalEvent.touches[0].clientX)),"touchmove"!==e.type&&i.scrollTop(i.scrollTop()+a-(e.clientY||e.originalEvent.touches[0].clientY)),s=e.clientX||e.originalEvent.touches[0].clientX,a=e.clientY||e.originalEvent.touches[0].clientY}).bind("touchend",function(e){return i.unbind("touchmove touchend"),setTimeout(function(){o.removeClass("moving movestart")},0),!1}))}))}),e("table.program td").each(function(){var t=e(this),n=d[t.data("pid")];if(n)if(0!==n.type){var i=e('<ul class="meta" />'),a=(c=e('<ul class="meta" />'),{en:"English",zh:"漢語"}[(this.className.match(/program_lang_(\w+)\b/)||[])[1]]),r=s[(this.className.match(/program_type_(\w+)\b/)||[])[1]];if(a&&i.append(e("<li />").text(a)),r&&i.append(e("<li />").text(r)),n.slide){h=e('<li><a href="'+n.slide+'">'+{en:"Slide","zh-tw":"投影片","zh-cn":"投影片"}[o||"en"]+"</a></li>");c.append(h),i.append(h.clone())}if(n.youtube){f="//www.youtube.com/embed/"+(p=[].concat(n.youtube)).shift()+"?hd=1";n.youtube.length&&(f+="&playlist="+p.join(",")),u=e('<li><a href="'+f+'" class="youtube_video">'+{en:"Video","zh-tw":"演講錄影","zh-cn":"演讲录影"}[o||"en"]+"</a></li>"),c.append(u),i.append(u.clone())}var l=e('<div class="info" />');i.children().length&&l.append(i),n.abstract&&l.append(e('<div class="abstract" />').html(n.abstract)),n.bio&&l.append(e('<div class="bio" />').html(n.bio)),c.children().length&&t.append(c),l.children().length&&t.append(l)}else{var c=e('<ul class="meta" />');if(n.slide){var h=e('<li><a href="'+n.slide+'">'+{en:"Slide","zh-tw":"投影片","zh-cn":"投影片"}[o||"en"]+"</a></li>");c.append(h)}if(n.youtube){var p,u,f="//www.youtube.com/embed/"+(p=[].concat(n.youtube)).shift()+"?hd=1";n.youtube.length&&(f+="&playlist="+p.join(",")),u=e('<li><a href="'+f+'" class="youtube_video">'+{en:"Video","zh-tw":"演講錄影","zh-cn":"演讲录影"}[o||"en"]+"</a></li>"),c.append(u)}c.children().length&&t.append(c)}}).bind("click",function(){var t=e(this),o=t.parents("div.program"),n=parseInt((this.className.match(/program_room_(\w+)\b/)||[])[1]),i=e(window).scrollTop()-t.offset().top;if(o.hasClass("moving"))return!1;switch(window._gaq&&_gaq.push(["_trackEvent","Program 2011",this.hash]),e(this).toggleClass("expend"),o.toggleClass("expend"),o.find("thead th:first, tbody th").translateTo(o.scrollLeft()),n){case 0:o.scrollLeft(.26*o[0].scrollWidth);break;case 1:o.scrollLeft(0);break;case 2:o.scrollLeft(.13*o[0].scrollWidth);break;case 3:o.scrollLeft(.38*o[0].scrollWidth);break;case 4:o.scrollLeft(o[0].scrollWidth)}e(window).scrollTop(t.offset().top+i)}),e(".program p.name a").bind("click",function(e){if(2==e.which||e.metaKey)return!0;e.preventDefault()}),e(".program .meta a, .program .info a").bind("click",function(t){if(2==t.which||t.metaKey)return!0;if(e(this).hasClass("youtube_video")&&!n()){if(e(document.body).append('<div id="video_modal" class="video_box" />').append('<iframe id="video_iframe" class="video_box" title="YouTube video player" width="854" height="483"  src="'+this.href+'" frameborder="0"  allowfullscreen="allowfullscreen"></iframe>').append('<div id="video_close_button" class="video_box" />'),0===e("#video_modal").offset().top){e(".video_box").css("position","absolute");var o=function(){e("#video_modal").css({top:0,left:0,width:document.body.scrollWidth,height:document.body.scrollHeight}),e("#video_iframe, #video_close_button").css({top:e(window).scrollTop()+(window.innerHeight||e(window).height())/2,left:e(window).scrollLeft()+(window.innerWidth||e(window).width())/2})};o(),e(window).bind("scroll.repositionvideo resize.repositionvideo",o).bind("pageload.repositionvideo",function(t){e(window).unbind("scroll.repositionvideo resize.repositionvideo").unbind(t)})}}else window.open(this.href);t.preventDefault(),t.stopPropagation()})}}function v(){var n=1310731200-Math.floor((new Date).getTime()/1e3);n<0&&(clearTimeout(t),e("#countdown").html({en:'<a href="//registrano.com/events/coscup2011-regist?locale=en">Register Now!</a>',"zh-tw":'<a href="//registrano.com/events/coscup2011-regist">立刻報名！</a>',"zh-cn":'<a href="//registrano.com/events/coscup2011-regist">立刻报名！</a>'}[o])),s=[],s[0]=(n%60).toString(10)+{en:" seconds","zh-cn":" 秒","zh-tw":" 秒"}[o],n=Math.floor(n/60),s[1]=(n%60).toString(10)+{en:" minutes ","zh-cn":" 分 ","zh-tw":" 分 "}[o],n=Math.floor(n/60),s[2]=(n%24).toString(10)+{en:" hours ","zh-cn":" 时 ","zh-tw":" 時 "}[o],(n=Math.floor(n/24))&&(s[3]=n.toString(10)+{en:" days ","zh-cn":" 天 ","zh-tw":" 天 "}[o]),e("#countdown-time").text(s.reverse().join(""))}e(window).bind("pageload",w),e("#video_modal, #video_close_button").live("click",function(){e(".video_box").remove(),e(window).unbind("scroll.repositionvideo resize.repositionvideo pageload.repositionvideo")}),/((blog|sponsor|register)\.)?coscup\.org\.?/.test(window.location.domain)||e.getJSON("https://coscup.org/2011/api/program.json",function(e){d=e,w()})})