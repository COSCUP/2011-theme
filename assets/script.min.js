jQuery(function(a){function k(){var b=[];a("#mobileSponsorLogo").remove();a.each({diamond:10,gold:5,silver:2,bronze:1},function(d,f){a("#sidebar > .sponsors ."+d+" a").each(function(){for(var a=f;a--;)b.push(this)})});b.length!==0&&a("#nav").after(a('<p id="mobileSponsorLogo" />').append(a(b[Math.floor(b.length*Math.random())]).clone()))}function l(){a("#sidebar2 > .images").imageTile({num:12,photos:yuren_54,beforeImageLoad:function(a){a.css("opacity",0)},imageLoad:function(a){a.css("opacity",1)}})}
function m(b,d){var f=a("<ul />"),g=[];if(d)for(var e=0,c;e<2;){c=d.results.shift();if(!c)break;!/plurk\.com/.test(c.source)&&!/^RT/.test(c.text)&&a.inArray(c.from_user,g)===-1&&(g.push(c.from_user),f.append(a("<li />").append(a('<span class="text" />').html(c.text)).append('<span class="meta"><a href="https://twitter.com/#!/'+c.from_user+"/status/"+c.id_str+'">@'+c.from_user+"</a></span>")),e++)}if(b)for(e=0;e<2;){c=b.plurks.shift();if(!c)break;b.users[c.user_id]&&!/plurk\.com\/(m\/)?\p\//.test(c.content)&&
a.inArray(b.users[c.user_id].nick_name,g)===-1&&(g.push(b.users[c.user_id].nick_name),f.append(a("<li />").append(a('<span class="text" />').html(c.content)).append('<span class="meta"><a href="http://www.plurk.com/p/'+c.plurk_id.toString(36)+'">@'+b.users[c.user_id].nick_name+"</a></span>")),e++)}a("#sidebar2 > .socialbuzz").empty().append(f)}function n(){a("#sidebar2 > .images").length&&(a.fn.imageTile?l():a.ajax({url:"http://coscup.org/2011-theme/assets/imagetile.min.js",dataType:"script",cache:!0,
success:l}));if(a("#sidebar2 > .socialbuzz").length){var b,d;a.getJSON("http://coscup.org/2011/api/plurk/",function(a){b=a;m(b,d)});a.getJSON("https://search.twitter.com/search.json?q=coscup+OR+from%3Acoscup&callback=?",function(a){d=a;m(b,d)})}}function q(){a(".hideInMobile iframe").each(function(){a(this).attr("data-src",this.src);this.src=""})}function r(){a("#sidebar2 iframe").each(function(){if(a(this).attr("data-src"))this.src=a(this).attr("data-src")})}function o(){k();a("#header").css("background-position",
"center -"+(75*Math.floor(Math.random()*4)).toString(10)+"px");a("#footer").css("background-position","center -"+(75*Math.floor(Math.random()*6)).toString(10)+"px");a("#title:visible").length?n():(window._gaq&&_gaq.push(["_trackEvent","Mobile 2011",window.location.href]),a(window).bind("resize.defer",function(){a("#title:visible").length&&(a(this).unbind("resize.defer"),n(),r())}),q())}function p(b){var d=a("#content").addClass("loading");a(window).unbind("resize.defer");i&&i.abort();i=a.ajax({url:b,
dataType:"html",cache:!0,complete:function(f,g){if(g==="success"||g==="notmodified"){var e=a("<div />").append(f.responseText.match(/<body\b([^\u0000]+)<\/body>/)[0].replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,""));document.title=f.responseText.match(/<title>(.+)<\/title>/)[1];d.html(e.find("#content").children()).removeClass("loading");e.find("#nav").is(".empty")||a("#nav").html(e.find("#nav").children());window._gaq&&_gaq.push(["_trackPageview"]);o()}else window.location.replace(b)}})}
var h=(a("html").attr("lang")||"zh-TW").toLowerCase();a("#nav.empty").length&&a.getJSON("http://coscup.org/2011/api/menu/?callback=?",function(b){a("#nav").removeClass("empty").html(b[h].replace(/href="(\/[^\/])/g,'href="http://coscup.org$1'));a('#nav a[href*="'+window.location.hostname+'"]').parent().addClass("current")});a("#sidebar > .sponsors.empty").length&&a.getJSON("http://coscup.org/2011/api/sponsors/?callback=?",function(b){var d=a("#sidebar > .sponsors").removeClass("empty"),f={en:{diamond:"Diamond Level Sponsors",
gold:"Gold Level Sponsors",silver:"Silver Level Sponsors",bronze:"Bronze Level Sponsors",media:"Media Partners"},"zh-tw":{diamond:"\u947d\u77f3\u7d1a\u8d0a\u52a9\u5546",gold:"\u9ec3\u91d1\u7d1a\u8d0a\u52a9\u5546",silver:"\u767d\u9280\u7d1a\u8d0a\u52a9\u5546",bronze:"\u9752\u9285\u7d1a\u8d0a\u52a9\u5546",media:"\u5a92\u9ad4\u5925\u4f34"},"zh-cn":{diamond:"\u94bb\u77f3\u7ea7\u8d5e\u52a9\u5546",gold:"\u9ec4\u91d1\u7ea7\u8d5e\u52a9\u5546",silver:"\u767d\u94f6\u7ea7\u8d5e\u52a9\u5546",bronze:"\u9752\u94dc\u7ea7\u8d5e\u52a9\u5546",
media:"\u5a92\u4f53\u4f19\u4f34"}}[h];a.each(b,function(b,e){d.append("<h2>"+f[b]+"</h2>");var c=a('<ul class="'+b+'" />');a.each(e,function(a,b){c.append('<li><a href="'+b.url+'" target="_blank"><img title="'+b.name[h]+'" src="'+b.logoUrl+'" /></a></li>')});d.append(c)});k()});a(".sponsors a, #mobileSponsorLogo a").live("click",function(){window._gaq&&_gaq.push(["_trackEvent","Sponsors 2011",this.href]);return!0});a("#mobileSponsorLogo a").live("click",function(){window._gaq&&_gaq.push(["_trackEvent",
"Sponsors 2011 (Mobile only)",this.href]);return!0});a("#nav > ul > li").bind("touchstart",function(){var b=a(this);b.addClass("selected");a(document.body).bind("touchend",function(d){b.removeClass("selected");a(this).unbind(d)})});o();var i;if(window.history&&history.pushState){a("a").live("click",function(a){if(a.which==2||a.metaKey)return!0;if(this.hostname!==window.location.hostname||!/2011/.test(this.pathname)||!RegExp(h).test(this.pathname.toLowerCase()))return!0;p(this.href);history.pushState(!0,
"",this.href);return!1});var j=!0;window.onpopstate=function(a){j&&!a.state?j=!1:(j=!1,p(window.location.href))}}});

